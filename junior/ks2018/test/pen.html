<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../css/jquery.mobile-1.4.5.min.css" />
    <script src="../js/jquery-2.1.4.min.js"></script>
    <script src="../js/jquery.mobile-1.4.5.min.js"></script>
    <script src="../js/fabric.min.js"></script>
    <script>
    $(document).on('pageshow', '#c1', function() {
	var canvas = new fabric.Canvas('c', { isDrawingMode: true, backgroundColor: '#fff', selection: true });
	console.log($('#main').width());
	canvas.setWidth($('#main').width());
	canvas.setHeight(500);
	canvas.renderAll();
	canvas.freeDrawingBrush.color = '#000000';
	canvas.freeDrawingBrush.width = 2;
	$(document).on('click', '#black', function() {
	    canvas.freeDrawingBrush.color = '#000000';
	    canvas.freeDrawingBrush.width = 2;
	});
	$(document).on('click', '#white', function() {
	    canvas.freeDrawingBrush.color = '#ffffff';
	    canvas.freeDrawingBrush.width = 30;
	});
	$(document).on('click', '#json', function() {
	    let png = canvas.toDataURL('png');
	    let js = JSON.stringify(canvas);
	    $('#jsonstr').html(png.length + ' ' + js.length);
	    console.log(png.length, js.length);
	});
    });
	
    </script>
  </head>
  <body>
    <div data-role="page" id="c1">
      <div data-role="header" data-position="fixed">
	<h1>テスト</h1>
      </div>
      <div class="ui-content" data-role="main" id="main">

	<canvas id="c" style="border:1px solid black"></canvas>
      
	<button type="button" id="black" data-mini="true" data-inline="true">BLACK</button>
	<button type="button" id="white" data-mini="true" data-inline="true">WHITE</button>
    <button type="button" id="json" data-mini="true" data-inline="true">toJSON</button>
    <div id="jsonstr"></div>
      
      </div>
    </div>
  </body>
</html>
